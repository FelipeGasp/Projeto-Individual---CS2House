<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS2House</title>


    <link rel="stylesheet" href="CSS/style.css">
    <link rel="stylesheet" href="CSS/dashboards.css">


</head>

<body onload="validarSessao()">

    <div class="janela">

        <div class="header-left dash-header">

            <h1>CS2House</h1>

            <div class="hello">
                <h3>Olá, <span id="b_usuario"></span>!</h3>
            </div>

            <div class="btn-nav">
                <h3>Geral</h3>
            </div>

            <div class="btn-nav-white">
                <a href="dashboard.html">
                    <h3>Dashboard</h3>
                </a>
            </div>

            <div class="btn-nav-white">
                <a href="Testes.html">
                    <h3>Testes</h3>
                </a>
            </div>

            <div class="btn-logout" onclick="limparSessao()">
                <h3>Sair</h3>
            </div>

        </div>

        <div class="dash1">
            <div class="secoes">
                <div class="containersecao">
                    <span>Seções disponíveis:</span>
                </div>
                <div class="containersecoes">
                    <div class="secao1">
                        <h4>Capitulo 1 | Por onde começar?</h4>
                        <br>
                        <iframe width="360" height="115"
                            src="https://www.youtube.com/embed/Pn3RQzg0p-8?si=3CkO9V0hbgzEZ7JX" title="Capitulo1"
                            frameborder="1"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                            referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                        <br>
                    </div>
                    <div class="secao1">
                        <br>
                        <h4>Capitulo 2 | Aprendendo o básico</h4>
                        <br>
                        <iframe width="360" height="115"
                            src="https://www.youtube.com/embed/zOWKBkUAhB8?si=vBiAu2z8JNmxQSeg" title="Capitulo2"
                            frameborder="1"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                            referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                        <br>
                    </div>
                </div>
                <div class="containersecoes2">
                    <br>
                    <h4>Capitulo 3 | Como ser imprevisivel </h4>
                    <br>
                    <iframe width="360" height="115" src="https://www.youtube.com/embed/x6wOUuRwcO8?si=DsesB-ihPlJqCA4P"
                        title="Capitulo2" frameborder="1"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                        referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                    <br>
                    <h4>Capitulo 4 | Como ler os adversários </h4>
                    <br>
                    <iframe width="360" height="115" src="https://www.youtube.com/embed/4qiaR5zOdAw?si=r-hTUQlGxCVaHmiU"
                        title="Capitulo2" frameborder="1"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                        referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                    <br>
                </div>
                <div class="containersecoes3">
                    <br>
                    <h4>Capitulo 5 | Entendendo funções </h4>
                    <br>
                    <iframe width="360" height="115" src="https://www.youtube.com/embed/L6DL_v4wnKQ?si=cdXGV8JQKTr1XWmj"
                        title="Capitulo2" frameborder="1"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                        referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                    <br>
                    <h4>Capitulo 6 | Como masterizar teamplay, playbook e o avançado do jogo</h4>
                    <br>
                    <iframe width="360" height="115" src="https://www.youtube.com/embed/PgUai78Kp6E?si=ee09WhQYXPW8qMoO"
                        title="Capitulo2" frameborder="1"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                        referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                    <br>
                </div>
                <h2 style="text-align: center;margin-top: 2%;">Métrica das aulas</h2><br>
                <div class="containercheck">
                    <span style="font-size: 20px;">Aula 1 > </span> <input type="checkbox" id="ipt_aula1">
                    <span style="font-size: 20px;">Aula 2 > </span> <input type="checkbox" id="ipt_aula2">
                    <span style="font-size: 20px;">Aula 3 > </span> <input type="checkbox" id="ipt_aula3">
                    <span style="font-size: 20px;">Aula 4 > </span> <input type="checkbox" id="ipt_aula4">
                    <span style="font-size: 20px;">Aula 5 > </span> <input type="checkbox" id="ipt_aula5">
                    <span style="font-size: 20px;">Aula 6 > </span> <input type="checkbox" id="ipt_aula6">
                        <button style="border-radius: 5%;padding: 5px 5px 5px 5px;background-color: #0c1323;color: rgb(255, 255, 255); font-family: 'Exo 2'" onclick="enviar_aula()">Confirmar e salvar aulas assistidas</button>
                </div>

            </div>
            <div class="bemvindo">
                <div class="containerBem">
                    <h1>Bem vindo ao site, assista as aulas e responda os testes usando a navbar!<br> Boas aulas!</h1>
                </div>
            </div>

        </div>

</body>

<script>
    var aulas_assistidas = 0;
    function validarSessao() {
        var email = sessionStorage.EMAIL_USUARIO;
        var nome = sessionStorage.NICK_USUARIO;

        var b_usuario = document.getElementById("b_usuario");

        if (email != null && nome != null) {
            b_usuario.innerHTML = nome;
        } else {
            window.location = "../login.html";
        }
    }

    function limparSessao() {
        sessionStorage.clear();
        window.location = "login.html";
    }
    function marcar_aula() {
        var idUsuario = sessionStorage.ID_USUARIO;
        if (ipt_aula1.checked||ipt_aula2.checked||ipt_aula3.checked||ipt_aula4.checked||ipt_aula5.checked||ipt_aula6.checked) {
            if(ipt_aula1.checked){
                aulas_assistidas++;
            }
            if(ipt_aula2.checked){
                aulas_assistidas++;
            }  if(ipt_aula3.checked){
                aulas_assistidas++;
            }  if(ipt_aula4.checked){
                aulas_assistidas++;
            }  if(ipt_aula5.checked){
                aulas_assistidas++;
            }     if(ipt_aula6.checked){
                aulas_assistidas++;
            }
}
    }
    function enviar_aula(){
        if (ipt_aula1.checked||ipt_aula2.checked||ipt_aula3.checked||ipt_aula4.checked||ipt_aula5.checked||ipt_aula6.checked) {
            if(ipt_aula1.checked){
                aulas_assistidas++;
            }
            if(ipt_aula2.checked){
                aulas_assistidas++;
            }  if(ipt_aula3.checked){
                aulas_assistidas++;
            }  if(ipt_aula4.checked){
                aulas_assistidas++;
            }  if(ipt_aula5.checked){
                aulas_assistidas++;
            }     if(ipt_aula6.checked){
                aulas_assistidas++;
            }
}
        var idUsuario = sessionStorage.ID_USUARIO;
        fetch(`/medidas/atualizarAulas/${idUsuario}`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                idUsuarioServer: sessionStorage.ID_USUARIO,
                aulasServer: aulas_assistidas
            })
        }).then(function (resposta) {
            console.log("ESTOU NO THEN DO entrar()!")

            if (resposta.ok) {
                console.log(resposta);
                alert('Aulas marcadas com sucesso!')

            } else {

                console.log("Houve um erro ao tentar realizar o update");
                resposta.text().then(texto => {
                    console.error(texto);
                });
            }

        }).catch(function (erro) {
            console.log(erro);
        })
    }

</script>

</html>